From 59ace120ac5ceb5f0d36e40e48e1884de1badf76 Mon Sep 17 00:00:00 2001
From: Michiel Rook <mrook@php.net>
Date: Thu, 20 Dec 2018 19:11:37 +0100
Subject: [PATCH] Don't allow filenames to start with phar://

---
 Archive/Tar.php | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/submodules/Archive_Tar/Archive/Tar.php b/submodules/Archive_Tar/Archive/Tar.php
index 0bd1c6c..57a6d87 100644
--- a/submodules/Archive_Tar/Archive/Tar.php
+++ b/submodules/Archive_Tar/Archive/Tar.php
@@ -1767,6 +1767,9 @@ private function _tarRecToSize($tar_size)
      */
     private function _maliciousFilename($file)
     {
+        if (strpos($file, 'phar://') === 0) {
+            return true;
+        }
         if (strpos($file, '/../') !== false) {
             return true;
         }
